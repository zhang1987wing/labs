# 股票回测系统

基于Python Flask的股票交易策略回测系统，支持多股票并行回测，提供Web界面和REST API。

## 🚀 功能特性

### 核心功能
- **多股票并行回测** - 支持同时回测多只股票
- **技术指标策略** - 基于MACD、RSI、布林带、DMI等指标
- **风险控制** - ATR止损、冷却期机制
- **实时进度** - 回测进度实时显示
- **可视化结果** - 图表展示回测结果

### 交易策略
- **买入条件**：MACD金叉 + DMI多头 + MA5>MA10 + 布林带突破
- **卖出条件**：ATR止损 + 布林带跌破 + 大量抛售
- **风险控制**：冷却期机制防止频繁交易

### QVIX恐慌指数
- **沪深300ETF** 期权波动率指数
- **中证1000** 指数期权波动率指数  
- **创业板ETF** 期权波动率指数
- **科创板50ETF** 期权波动率指数

## 📦 安装依赖

```bash
pip3 install -r requirements.txt
```

## 🏃‍♂️ 运行系统

### 启动Web服务器
```bash
python3 app.py
```

### 访问Web界面
打开浏览器访问：http://localhost:5000

## 🔧 API接口

### 开始回测
```http
POST /api/backtest
Content-Type: application/json

{
    "stock_codes": ["000001", "600036"],
    "initial_capital": 10000,
    "start_date": "2024-01-01", 
    "end_date": "2024-12-31"
}
```

### 查询回测状态
```http
GET /api/backtest/{task_id}
```

### 搜索股票
```http
GET /api/stock/search?keyword=平安
```

### 获取QVIX指数
```http
GET /api/qvix
GET /api/qvix?date=2024-01-01
```

## 📁 项目结构

```
stock/
├── app.py                 # Flask应用主文件
├── stock_trading.py       # 交易策略和回测引擎
├── stock_indicators.py    # 技术指标计算
├── stock_watchlist.py     # 股票筛选策略
├── stock_agent.py         # LSTM价格预测
├── templates/
│   └── backtest.html     # 回测页面模板
├── model/                # 数据模型
└── requirements.txt      # 依赖包列表
```

## 🎯 使用步骤

1. **配置参数**
   - 选择股票代码（支持搜索）
   - 设置初始资金（建议1万-100万）
   - 选择回测时间范围

2. **执行回测**
   - 点击"开始回测"按钮
   - 实时查看回测进度
   - 等待回测完成

3. **查看结果**
   - 汇总统计信息
   - 收益率分布图表
   - 详细回测结果

## 📊 结果解读

### 汇总指标
- **总盈亏** - 所有股票的盈亏总和
- **平均收益率** - 各股票收益率的算术平均
- **胜率** - 盈利交易占总交易的比例
- **最佳/最差表现** - 收益率最高/最低的股票

### QVIX指数解读
- **0-20**: 市场平静，低波动
- **20-30**: 正常波动范围
- **30-40**: 市场恐慌，高波动
- **>40**: 极度恐慌，可能的抄底机会

## ⚠️ 使用建议

1. **参数设置**
   - 初始资金建议设置为1万-100万元
   - 回测期间建议至少6个月
   - 同时回测股票数量建议不超过10只

2. **结果分析**
   - 关注胜率和平均收益率的平衡
   - 注意最大回撤和风险控制
   - 结合QVIX指数判断市场环境

3. **风险提示**
   - 历史回测不代表未来表现
   - 实盘交易需考虑滑点和手续费
   - 建议小资金验证后再扩大规模

## 🔮 未来功能

- [ ] 更多技术指标和策略
- [ ] 实盘交易接口对接
- [ ] 风险指标计算（夏普比率、最大回撤等）
- [ ] 策略参数优化
- [ ] 历史回测结果保存

## 📄 许可证

本项目仅供学习和研究使用，不构成投资建议。